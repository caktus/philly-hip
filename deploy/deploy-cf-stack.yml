---
- name: kubernetes stack management
  hosts: cluster
  vars:
    ansible_connection: local
    ansible_python_interpreter: "{{ ansible_playbook_python }}"
    environment:
      AWS_ACCESS_KEY_ID: ""
      AWS_SECRET_ACCESS_KEY: ""
      AWS_SESSION_TOKEN: ""
      AWS_SECURITY_TOKEN: ""
  gather_facts: false
  roles:
    - role: caktus.aws-web-stacks
  tasks:
    - name: Prompt if CloudFormation stack changed
      pause:
        prompt: >
          A changeset was created for the CloudFormation stack. You MUST login to the AWS console,
          inspect the changeset, and if everything looks good (i.e., it's not DELETING anything
          unexpectedly), execute the changeset. When complete, hit RETURN to continue or Control-C,
          then A to abort.
      when: cloudformation_stack_result is changed
